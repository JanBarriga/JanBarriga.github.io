<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <title>Web de Jan</title>
    <style>
        
    
body {
            padding: 20px; /* Espai extra per als marges laterals */
        }
.navbar-brand {
    display: flex;
    align-items: center;
}

.logo {
    margin-right: 20px; /* Ajusta aquest valor segons el necessari */
}

.brand-text {
    white-space: nowrap; /* Això assegura que el text no es trenqui en múltiples línies */
    font-size: 1.25rem; /* Ajusta la mida de la font si és necessari */
}  
.content-container {
            margin-left: 10px;
            margin-right: 10px; /* Marges laterals ajustats */
            margin-top: 20px; /* Afegeix espai superior entre el contingut i la barra de menú */
        }
    </style>
</head>
<body>
 <div>
    <h1> Conceptes generals de microcontroladors</h1>
  <p>El diferents microcontroladors tenen en comú el seguents aspectes</p>
  <li>Tipus de entrades i sortides: El microcontrolador te un procesador tipus AVR o Espressif. Es poden conectar entrades
    analogiques, digital i sortides analogiques o digitals</li>
  <li> Les entrades digitals nomes funcionen amb 0 i 1 es a dir, codi binari. Zero siginifica 0 volts, 
    i 1 significa 5 volts o 3,3 volts. Depenen del microcontrolador</li>

</ul>
<h2> Sortides analogiques tipus PWM </h2>
<p> PWM significa modulació de l'ample de banda en angles: Pulse with Modulation</i>
i es una forma d'aconseguir una sortida analògica a partir de diverses sortides digitals molt rapides </p>
<p> PWM es representa amb el simbol "~" tal com podem veure a la imatge d'un arduino uno</p>
<img src="arduino.jpg" width="600" height="400">
<p> Els pins amb PWM en l'arduino uno son el següents: 3,5,6,9,10 i 11. 
  que son sortides analogiques de 8 bits. <a href="https://docs.arduino.cc/resources/datasheets/A000066-datasheet.pdf">  Com diu a les especificacions del fabricant</p> </a>
 <p> <a href="https://docs.arduino.cc/resources/datasheets/ABX00080-datasheet.pdf"> </a>
 Mentres, que en el cas del arduino rev4 usa 12 bits. Anomenat pel fabricant com a DAC <i>(DIGITAL ANALOG CONVERTER)</i>  </p>
 <p> Tenir 8 o 12 bits en un convertidor DAC tipus PWM fa que tinguem 2<sup>8</sup> o 2<sup>10</sup> nivells differents de corrent,
 es a dir 256 nivells diferents o 2048 nivells diferents</p>

  <p>Tenir 8 o 12 bits en un convertidor digital analògic o DAC tipus PWM fa que tinguem 2<sup>8</sup> o 2<sup>10</sup> nivells 
   diferents de corrent, es a dir 256 nivells diferents o 2048 nivells diferents</p>

<p>Suposem que Arduino Uno Rev3 o Rev4 podem donar 5 volts com a màxim. Quina seria la resolució en milivolts de cada Arduino?</p>
<p> 5 volts dividit entre 256 dona 0.01953125 volts = 19.53125 milivolts per arduino Rev3</p>
<p> 5 volts dividit entre 2048 dona 0.00244140625 volts = 2.44140625 milivolts per arduino Rev4</p>
<p>Els milivolts anteriors són la resolució que aconseguim. Imaginem que volem regular la intensitat d'un LED amb un Arduino Uno Rev3 aconseguim
menys fluid i amb graons més grans, és a dir canvis més bruscs perquè 256 canvis són menys que 2048 volts. A continuació veurem una imatge que representa
com combinant moltes senyals digitals ràpidament sembla que generem un senyal analògi i això és la base del PWM.</p>
<img src="pmw.PNG" widht="600" height="450">
<p>Quan major és l'amplada del pols vol dir que major és el temps que la sortida digital està en voltatge alt,
   per exemple 5V i menys temps està a 0V, i per tant el promig  de tots els polsos és més alt. En canvi si 
   per exemple si cada pols és més estret a 5V vol dir que estarà més temps a 0V, i per tant el promig  de
   tots els polsos és més baix. A la imatge de a dalt es pot veure com s'encendria un LED o un motor funcionaria a una velocitat 
   del 10%, 30%, 50%, 90%. Quin persentatge del senyal canviara en un cas i en un altre?</p>
  <ul>
    <li>(0,01953125/5)*100 = 0,390625%</li>
    <li>(0,00244140625/5)*100 = 0,048828125%</li>
  </ul>  
<p>A la taula a continuació veuras els valors per defecte de la freqüència PWM en Arduino Uno Rev3</p>
<table>
  <thead>
    <tr>
      <th>PIN de Sortida</th><th>Freqüència</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>PINS: 3, 9, 10, 11</td>
      <td>490 Hz</td>
    </tr>
    <tr>
      <td>PINS: 5 i 6</td>
      <td>976 Hz</td>
    </tr>
  </tbody>
</table>
    <p>Nota: La taula HTML anterior té una capçalera com un document HTML, però és diu thead, en comptes de head i és la primera filera de la taula.
    Té un cos anomenat tbody, en comptes de body i és la reta de la taula. 
    La taula la defineix el tag table que agrupa thead y tbody. Totes les fileres tant del thead com del tbody es defineixen amb el tag tr, que vol dir <i>table row</i>. 
    Dintre de thead hi ha elements individuals que són cel·les que pertanyen a la primera
    filera que s'anomenen th o <i>table heading</i>.
    En el table body hi ha també fileres tr, però dintre d'aquestes fileres els elements individuals han de ser td, que significa <i>table data</i>.
    per últim, s'han de tancar el table o body. Tots aquests elements es poden modificar amb CSS i fer la taula amb un estil propi</p>
    <p>Les freqüencies baixes produeixen sorolls en els motors. Per tant, és preferible connectar motors als pins 5 i 6.</p>
    <p>La freqüencia és la inversa del periòde, 976 Hz o cicles per segon correspo a un periòde de 1/976 segons, que són 1,024 milisegons</p>

    <h2>Convertidor analògic - digital</h2>
      <p>Apliquem el teorema de Nyquist que diu que hem de fer el doble de mostres com a mínim que la freqüencia màxima per aconseguir convertir
       un senyal contínu analògic en un senyal digital mostrejat segons la figura següent</p>

  <img src="nyquist.png" width="600" heigth="400">
  <p>Nyquist és important perquè si en el codi poso una freqüencia de mostreig de 20 Hz per un so no fucionarà perque la freqüencia
  mínima del so és 20 Hz i la màxima 20 KHz pel que refereix al so audible en humans. Això és perque agafes mostres massa grans i no podem veure 
  pujades i baixades de la senyal.</p>
  <p>A continuació veurem una taula comparativa sobre els microcontroladors Arduino UNo i ESP32S3 i el circcuit ha ADS1115</p>
    <table>
        <thead>
            <tr>
                <th>Microcontrolador i o circuit</th>
                <th>Número de bits(Nivells)</th>
                <th>Voltatge</th>
            </tr>
            <tr>
                <td>Arduino Uno</td>
                <td>10 (0-1023)</td>
                <td>0-5V, 0-3.3V</td>
            </tr>
            <tr>
                <td>ESP32S3</td>
                <td>12 (0-4095)</td>
                <td>0-3.3V</td>
            </tr>
            <tr>
                <td>ADS1115</td>
                <td>16 (0-65536)</td>
                <td>0-3.3V</td>
            </tr>
        </thead>
    </table>
<pre><code>
  int valorADC= 0;
  void setup(){
    Serial.begin(9600);//9600 en Arduino o 115200 en S3
    }
    void loop(){
    valor ADC = analog.Read(A0);//34 en S3
    Serial println(valorADC);//0-1023 o 0-4095
    delay(500);}  
</pre></code>
</body>
</html>

   




